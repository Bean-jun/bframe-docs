{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u4e3b\u9875","text":"<p><code>bframe</code>\u662f\u4e00\u4e2a\u57fa\u4e8e<code>WSGI</code>\u7684\u534f\u8bae\u7684<code>web</code>\u6846\u67b6\u3002\u5b83\u975e\u5e38\u50cf<code>flask</code>\uff0c\u4f46\u4e5f\u4f1a\u6709<code>django restframework</code>\u7684\u5473\u9053\u3002</p> <p><code>bframe</code>\u7684\u521d\u8877\u662f\u4e3a\u4e86\u5b66\u4e60<code>python</code>\u7684<code>web</code>\u6846\u67b6\uff0c\u52a0\u6df1\u5bf9<code>WSGI</code>\u53ca\u5468\u8fb9\u751f\u6001\u7684\u4e86\u89e3\u3002\u5f53\u7136\uff0c\u82e5\u60a8\u60f3\u66f4\u6df1\u5165\u7684\u4e86\u89e3<code>python web</code>\u5f00\u53d1\uff0c\u8bf7\u53c2\u4e0e\u8fdb\u6765\u5427\uff01</p>"},{"location":"#users-guide","title":"User's Guide","text":"<p>bframe\u7684\u4f7f\u7528\u6bd4\u8f83\u7b80\u5355\uff0c\u76f8\u6bd4\u66f4\u4e3a\u590d\u6742\u7684<code>django</code>\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5\u5c1d\u8bd5\u624b\u6495\u672c\u9879\u76ee\u7684\u6e90\u7801\uff0c\u4f46\u5728\u8fd9\u4e4b\u524d\uff0c\u8bf7\u7b80\u5355\u770b\u4e00\u4e0b\u6211\u4eec\u7684\u4f7f\u7528\u6307\u5357</p> <ul> <li> <p>\u5b89\u88c5</p> <ul> <li>Python Version</li> <li>Installation bframe</li> </ul> </li> <li> <p>\u5feb\u901f\u5165\u95e8</p> <ul> <li>polls\u6295\u7968\u5e94\u7528</li> <li>\u5176\u4ed6</li> </ul> </li> <li> <p>\u6559\u7a0b</p> <ul> <li>wsgi\u652f\u6301</li> <li>\u6dfb\u52a0\u94a9\u5b50\u652f\u6301</li> <li>\u652f\u6301\u91cd\u5b9a\u5411</li> <li>\u652f\u6301g\u53d8\u91cf</li> <li>\u89e3\u6790\u8bf7\u6c42\u4f53</li> <li>\u652f\u6301\u8def\u5f84\u53c2\u6570\u5339\u914d</li> <li>\u652f\u6301\u9759\u6001\u6587\u4ef6</li> <li>\u652f\u6301\u89e3\u6790py\u914d\u7f6e\u6587\u4ef6</li> <li>\u652f\u6301\u7c7b\u89c6\u56fe</li> <li>\u652f\u6301\u901a\u7528\u7c7b\u89c6\u56fe&amp;\u9ed8\u8ba4\u8def\u7531</li> <li>\u6846\u67b6\u9ed8\u8ba4\u914d\u7f6e</li> </ul> </li> <li> <p>API</p> <ul> <li>\u7ed3\u6784\u6811</li> </ul> </li> <li> <p>TODO</p> <ul> <li>\u66f4\u65b0\u9879\u76ee\u6587\u6863</li> <li>\u66f4\u65b0\u9879\u76ee\u6d4b\u8bd5\u7528\u4f8b</li> <li>\u9879\u76ee\u529f\u80fd\u6269\u5c55</li> </ul> </li> <li> <p>\u7248\u672c</p> <ul> <li>Version 0.0.17</li> <li>Version 0.0.16</li> <li>Version 0.0.15</li> <li>Version 0.0.14</li> <li>Version 0.0.13</li> <li>Version 0.0.12</li> <li>Version 0.0.11</li> <li>Version 0.0.10</li> <li>Version 0.0.9</li> <li>Version 0.0.8</li> <li>Version 0.0.7</li> <li>Version 0.0.6</li> <li>Version 0.0.5</li> <li>Version 0.0.4</li> <li>Version 0.0.3</li> <li>Version 0.0.2</li> <li>Version 0.0.1</li> </ul> </li> </ul>"},{"location":"api/","title":"API","text":""},{"location":"api/#_1","title":"\u7ed3\u6784\u6811","text":"<pre><code>.\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 _except.py              # \u5f02\u5e38\n\u251c\u2500\u2500 config.py               # \u6846\u67b6\u914d\u7f6e\n\u251c\u2500\u2500 ctx.py                  # \u6846\u67b6\u4e0a\u4e0b\u6587\n\u251c\u2500\u2500 frame.py                # frame\u6846\u67b6\n\u251c\u2500\u2500 generics.py             # \u901a\u7528\u7c7b\u89c6\u56fe\n\u251c\u2500\u2500 local.py                # \u6846\u67b6\u672c\u5730\u7ebf\u7a0b\u5bf9\u8c61\n\u251c\u2500\u2500 logger.py               # \u6846\u67b6\u901a\u7528\u65e5\u5fd7\u6587\u4ef6\u5e93\n\u251c\u2500\u2500 route.py                # \u6846\u67b6\u8def\u7531\n\u251c\u2500\u2500 scaffold.py             # frame\u6846\u67b6\u9aa8\u67b6\n\u251c\u2500\u2500 serizlizer.py           # \u901a\u7528\u7c7b\u89c6\u56fe\u5e8f\u5217\u5316\u5de5\u5177\u5e93\n\u251c\u2500\u2500 server.py               # \u6846\u67b6\u63d0\u4f9b\u7684\u5185\u7f6eserver\n\u251c\u2500\u2500 sessions.py             # \u6846\u67b6\u63d0\u4f9b\u5bf9session\u7684\u652f\u6301\n\u251c\u2500\u2500 testing.py              # \u6846\u67b6\u63d0\u4f9b\u7684\u5bf9\u5355\u5143\u6d4b\u8bd5\u5de5\u5177\n\u251c\u2500\u2500 utils.py                # \u6846\u67b6\u63d0\u4f9b\u7684\u90e8\u5206\u5de5\u5177\n\u251c\u2500\u2500 view.py                 # \u7c7b\u89c6\u56fe\n\u251c\u2500\u2500 wrappers.py             # \u6846\u67b6\u5bf9\u8bf7\u6c42\u3001\u54cd\u5e94\u7684\u5305\u88c5\u5668\n\u2514\u2500\u2500 wsgi.py                 # \u6846\u67b6\u5bf9wsgi\u7684\u652f\u6301\n</code></pre>"},{"location":"changes/","title":"\u7248\u672c","text":""},{"location":"changes/#version-0017","title":"Version 0.0.17","text":"<p>Released 2023-10-27</p> <ul> <li>\u6dfb\u52a0\u5b50\u5e94\u7528(<code>yellowprint</code>)\u652f\u6301</li> </ul>"},{"location":"changes/#version-0016","title":"Version 0.0.16","text":"<p>Released 2023-10-12</p> <ul> <li>\u5f69\u8272\u65e5\u5fd7\u8f93\u51fa</li> <li>\u66f4\u65b0\u6295\u7968\u5e94\u7528\u5165\u95e8\u6559\u7a0b</li> <li>\u66f4\u65b0\u6253\u5305\u5de5\u5177\u94fe</li> </ul>"},{"location":"changes/#version-0015","title":"Version 0.0.15","text":"<p>Released 2023-09-26</p> <ul> <li>\u6dfb\u52a0\u5bf9\u901a\u7528\u7c7b\u89c6\u56fe\u7684\u652f\u6301</li> <li>\u6dfb\u52a0\u9879\u76ee\u6587\u6863</li> </ul>"},{"location":"changes/#version-0014","title":"Version 0.0.14","text":"<p>Released 2023-09-20</p> <ul> <li>\u6dfb\u52a0\u5bf9cookie\u7684\u652f\u6301</li> <li>\u6dfb\u52a0\u5bf9session\u7684\u652f\u6301</li> </ul>"},{"location":"changes/#version-0013","title":"Version 0.0.13","text":"<p>Released 2023-09-06</p> <ul> <li>\u6dfb\u52a0\u5bf9\u7c7b\u89c6\u56fe\u7684\u652f\u6301</li> <li>\u6dfb\u52a0\u90e8\u5206\u6d4b\u8bd5\u7528\u4f8b</li> </ul>"},{"location":"changes/#version-0012","title":"Version 0.0.12","text":"<p>Released 2023-07-13</p> <ul> <li>\u4fee\u590d\u5bf9wsgi\u7684\u5f02\u5e38\u5904\u7406</li> <li>\u652f\u6301\u81ea\u5b9a\u4e49\u72b6\u6001\u7801</li> <li>\u4fee\u590dquery params\u7684\u5f02\u5e38\u5339\u914d</li> <li>\u4e00\u4e9b\u7b80\u5355\u7684\u4fee\u6539</li> </ul>"},{"location":"changes/#version-0011","title":"Version 0.0.11","text":"<p>Released 2023-04-09</p> <ul> <li>\u6dfb\u52a0\u5bf9config\u6587\u4ef6\u7684\u89e3\u6790\uff1b</li> <li>\u6dfb\u52a0current_app\u4e0a\u4e0b\u6587\u7684\u652f\u6301\uff1b</li> </ul>"},{"location":"changes/#version-0010","title":"Version 0.0.10","text":"<p>Released 2023-04-08</p> <ul> <li>\u4fee\u590d\u8bf7\u6c42\u4f53\u4e3a\u7a7a\u7684\u5f02\u5e38\uff1b</li> <li>\u4fee\u590d\u8bf7\u6c42\u4f53\u4e71\u7801\u5f02\u5e38\uff1b</li> <li>\u4fee\u590d\u6dfb\u52a0\u8def\u7531\u5f02\u5e38\uff1b</li> <li>\u6dfb\u52a0\u4e00\u4e2asimple todo app</li> </ul>"},{"location":"changes/#version-009","title":"Version 0.0.9","text":"<p>Released 2023-04-08</p> <ul> <li>\u652f\u6301\u6b63\u5219\u5339\u914d\u8def\u5f84\u53c2\u6570&amp;\u9759\u6001\u6587\u4ef6\uff1b</li> <li>\u6dfb\u52a0\u5bf9\u9759\u6001\u6587\u4ef6\u7684\u8def\u7531\u652f\u6301</li> </ul>"},{"location":"changes/#version-008","title":"Version 0.0.8","text":"<p>Released 2023-04-07</p> <ul> <li>\u652f\u6301\u7b80\u6613\u8def\u5f84\u53c2\u6570\u5339\u914d;</li> <li>\u4fee\u6b63request\u521d\u59cb\u5316\u53c2\u6570\u6570\u636e\u5f02\u5e38\uff1b</li> </ul>"},{"location":"changes/#version-007","title":"Version 0.0.7","text":"<p>Released 2023-04-06</p> <ul> <li>\u4e3a\u6846\u67b6\u652f\u6301Test Client&amp;\u6dfb\u52a0\u6d4b\u8bd5\u7528\u4f8b</li> </ul>"},{"location":"changes/#version-006","title":"Version 0.0.6","text":"<p>Released 2023-04-05</p> <ul> <li>\u63d0\u5347\u89e3\u6790\u8bf7\u6c42\u4f53\u65f6\u7684\u6027\u80fd</li> </ul>"},{"location":"changes/#version-005","title":"Version 0.0.5","text":"<p>Released 2023-04-05</p> <ul> <li>\u89e3\u6790HTTP\u8bf7\u6c42\uff0c\u5c01\u88c5\u8bf7\u6c42\u4f53</li> </ul>"},{"location":"changes/#version-004","title":"Version 0.0.4","text":"<p>Released 2023-04-05</p> <ul> <li>\u5c01\u88c5g\u53d8\u91cf\uff0c\u7528\u4e8e\u4e00\u4e2a\u8bf7\u6c42\u5468\u671f\u4e2d\u4f20\u9012\u6570\u636e</li> </ul>"},{"location":"changes/#version-003","title":"Version 0.0.3","text":"<p>Released 2023-04-04</p> <ul> <li>\u66f4\u65b0\u91cd\u5b9a\u5411\u529f\u80fd\uff1b</li> <li>\u4e3arequest\u6dfb\u52a0\u7c7b\u578b\u6ce8\u89e3\uff0c\u4f18\u5316\u7528\u6237\u4f7f\u7528\uff1b</li> <li>\u90e8\u5206\u7cfb\u7edf\u65b9\u6cd5\u79c1\u6709\u5316&amp;\u5c01\u88c5\u9632\u6b62\u7528\u6237\u8bef\u64cd\u4f5c</li> </ul>"},{"location":"changes/#version-002","title":"Version 0.0.2","text":"<p>Released 2023-04-04</p> <ul> <li>\u652f\u6301\u8bf7\u6c42\u5904\u7406\u94a9\u5b50</li> </ul>"},{"location":"changes/#version-001","title":"Version 0.0.1","text":"<p>Released 2023-04-04</p> <ul> <li>mini web frame</li> </ul>"},{"location":"installation/","title":"\u5b89\u88c5","text":""},{"location":"installation/#python-version","title":"Python Version","text":"<p>\u6211\u4eec\u63a8\u8350\u4f7f\u7528python3\uff0c\u6700\u597d\u5927\u4e8epython 3.8</p>"},{"location":"installation/#installation-bframe","title":"Installation bframe","text":"<pre><code>pip install bframe\n</code></pre>"},{"location":"quickstart/","title":"\u5feb\u901f\u5165\u95e8","text":""},{"location":"quickstart/#polls","title":"polls","text":"<p>\u6295\u7968\u5e94\u7528\uff0c\u76f8\u5173\u6e90\u7801\u8bf7\u53c2\u8003\u672c\u9879\u76eetutorial\u76ee\u5f55\u4e0b\u7684polls\u5e94\u7528</p> <ul> <li>1. \u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684app\u5e94\u7528</li> <li>2. \u7f16\u5199\u914d\u7f6e\u6587\u4ef6&amp;\u6570\u636e\u5e93\u6a21\u578b</li> <li>3. \u89c6\u56fe\u7684\u5c0f\u8bd5\u725b\u5200</li> <li>4. \u6dfb\u52a0\u7528\u6237\u8ba4\u8bc1\u529f\u80fd\uff0c\u8ba9\u6295\u7968\u66f4\u5177\u5907\u771f\u5b9e\u6027</li> <li>5. \u5f00\u53d1\u524d\u7aef\u754c\u9762\uff0c\u8ba9\u6295\u7968\u5e94\u7528\u754c\u9762\u4ea4\u4e92\u66f4\u52a0\u4eba\u6027\u5316</li> </ul>"},{"location":"quickstart/#_1","title":"\u5176\u4ed6","text":"<p>\u8bf7\u53c2\u8003\u672c\u9879\u76eetutorial\u76ee\u5f55\u4e0b\u7684\u6848\u4f8b</p> <ul> <li>bframer ---- \u4e00\u4e2a\u7b80\u5355\u7684\u6587\u672c\u8bb0\u5f55\u7f51\u9875</li> <li>shortUrl ---- \u4e00\u4e2a\u7b80\u5355\u7684\u77ed\u8fde\u63a5\u670d\u52a1\u5668</li> </ul>"},{"location":"todo/","title":"TODO","text":""},{"location":"todo/#_1","title":"\u66f4\u65b0\u9879\u76ee\u6587\u6863","text":"<ul> <li>[\u221a] \u6dfb\u52a0\u5feb\u901f\u5165\u95e8\u6587\u6863</li> <li>\u6dfb\u52a0API\u6587\u6863</li> </ul>"},{"location":"todo/#_2","title":"\u66f4\u65b0\u9879\u76ee\u6d4b\u8bd5\u7528\u4f8b","text":"<ul> <li>\u6dfb\u52a00.0.14\u7248\u672c\u4e2dcookie&amp;session\u7684\u6d4b\u8bd5\u7528\u4f8b</li> <li>\u6dfb\u52a00.0.15\u7248\u672c\u4e2dgeneric\u7c7b\u89c6\u56fe\u7684\u6d4b\u8bd5\u7528\u4f8b</li> </ul>"},{"location":"todo/#_3","title":"\u9879\u76ee\u529f\u80fd\u6269\u5c55","text":"<ul> <li>\u5c1d\u8bd5\u6dfb\u52a0\u5bf9ASGI\u534f\u8bae\u7684\u652f\u6301</li> <li>\u5c1d\u8bd5\u5bf9WebSocket\u7684\u652f\u6301</li> </ul>"},{"location":"tutorial/","title":"\u6559\u7a0b","text":""},{"location":"tutorial/#wsgi","title":"wsgi\u652f\u6301","text":"<p>\u82e5\u60a8\u9700\u8981\u4f7f\u7528wsgi\u529f\u80fd\u7684\u652f\u6301\uff0c\u4f7f\u7528<code>WSGIProxy</code>\u7c7b\u8fdb\u884c\u5305\u88c5\u5373\u53ef</p> <pre><code>from bframe import WSGIProxy\nfrom wsgiref.simple_server import make_server\nwith make_server('', 7256, WSGIProxy(app)) as httpd:\nprint(\"Serving on port 7256...\")\nhttpd.serve_forever()\n</code></pre>"},{"location":"tutorial/#_1","title":"\u6dfb\u52a0\u94a9\u5b50\u652f\u6301","text":"<p>\u5b9a\u4e49\u8bf7\u6c42\u94a9\u5b50 </p> <pre><code># \u5b9a\u4e49\u8bf7\u6c42\u94a9\u5b50\n@app.add_before_handle\ndef before_01():\nif request.Method == \"POST\":\nreturn \"disallow method\"\n</code></pre> <p>\u5b9a\u4e49\u54cd\u5e94\u94a9\u5b50 </p> <pre><code># \u5b9a\u4e49\u54cd\u5e94\u94a9\u5b50\n@app.add_after_handle\ndef after_01(resp: Response):\nprint(\"resp:\", resp.Code)\nreturn resp\n</code></pre> <p>\u81ea\u5b9a\u4e49\u9519\u8bef\u54cd\u5e94 </p> <pre><code># \u81ea\u5b9a\u4e49\u9519\u8bef\u54cd\u5e94\n@app.add_error_handle(401)\ndef err_401():\nreturn \"401 error\"\n</code></pre>"},{"location":"tutorial/#_2","title":"\u652f\u6301\u91cd\u5b9a\u5411","text":"<pre><code>from bframe import Redirect, request\n@app.get(\"/short_url\")\ndef short_url():\nreturn Redirect(request.args.get(\"returnUrl\"))\n</code></pre>"},{"location":"tutorial/#g","title":"\u652f\u6301g\u53d8\u91cf","text":"<pre><code>from bframe import Frame, g, request\napp = Frame(__name__)\n@app.add_before_handle\ndef before_01():\nusername = request.Headers.get(\"username\")\ng.username = username\n@app.get(\"/profile\")\ndef profile():\nreturn {\"username\": g.username}\n</code></pre>"},{"location":"tutorial/#_3","title":"\u89e3\u6790\u8bf7\u6c42\u4f53","text":"<pre><code>from bframe import request\n@app.route(\"/\", [\"get\", \"post\"])\ndef index():\nprint({\"args\": request.args,\n\"forms\": request.forms,\n\"files\": request.files,\n})\nreturn \"ok\"\n</code></pre>"},{"location":"tutorial/#_4","title":"\u652f\u6301\u8def\u5f84\u53c2\u6570\u5339\u914d(\u5b57\u7b26\u4e32\u3001\u6570\u5b57\u3001\u6b63\u5219)","text":"<pre><code>@app.get(\"/api/&lt;reg:(?P&lt;version&gt;v\\d+$)&gt;/user/&lt;int:pk&gt;\")\ndef user_api(version, pk):\nreturn {\"api_version\": version, \"path_args\": pk}\n</code></pre>"},{"location":"tutorial/#_5","title":"\u652f\u6301\u9759\u6001\u6587\u4ef6","text":"<pre><code>app = Frame(__name__, static_url=\"static\", static_folder=\"static\")\n</code></pre>"},{"location":"tutorial/#py","title":"\u652f\u6301\u89e3\u6790py\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>app.Config.from_py(\"config\")\n</code></pre>"},{"location":"tutorial/#cookiesession","title":"\u652f\u6301cookie&amp;session\u64cd\u4f5c","text":"<pre><code>from bframe import Frame\nfrom bframe import make_response\nfrom bframe import session\napp = Frame(__name__)\n@app.get(\"/\")\ndef index():\nret = make_response(\"hello world\")\nsess[\"username\"] = \"tom\"\nret.set_cookies(\"x-username\", \"tom\", path=\"/\")\nreturn ret\n@app.get(\"/home\")\ndef home():\nusername = sess[\"username\"]\nif not username:\nreturn \"not login\"\nprint(request.Cookies.get(\"x-username\"))\nret = make_response(\"home\")\nreturn ret\nif __name__ == \"__main__\":\napp.run()\n</code></pre>"},{"location":"tutorial/#_6","title":"\u652f\u6301\u7c7b\u89c6\u56fe","text":"<pre><code>from bframe import MethodView\napp = Frame(__name__)\nclass BookView(MethodView):\ndef get(self):\nreturn books\ndef post(self):\nglobal books\nreq = request.forms\nreq['id'] = len(books) + 1\nbooks.append(req)\nreturn req\napp.add_route(\"/book\", BookView.as_view())\nif __name__ == \"__main__\":\napp.run()\n</code></pre>"},{"location":"tutorial/#_7","title":"\u652f\u6301\u901a\u7528\u7c7b\u89c6\u56fe&amp;\u9ed8\u8ba4\u8def\u7531","text":"<pre><code>from bframe.serizlizer import SimpleSerializer\nfrom sqlalchemy import create_engine, Column, Integer, String, Float\nfrom sqlalchemy.orm import sessionmaker\nfrom sqlalchemy.orm import declarative_base\nengine = create_engine('sqlite:///database.db', echo=True)\nBase = declarative_base()\nclass Phone(Base):\n__tablename__ = 'phones'\nid = Column(Integer, primary_key=True)\nname = Column(String)\nprice = Column(Float)\n# Base.metadata.create_all(engine)\nSession = sessionmaker(bind=engine)\nsession = Session()\nclass PhoneViewSet(ViewSet):\ndecorators = [prue_response_decorator]\ntable_class = Phone\ntable_serializer = SimpleSerializer\ndef get_session(self):\nreturn session\n# ================================\napp.add_route(\"/phone\", PhoneViewSet.as_view({\n\"get\": \"list\",\n\"post\": \"create\",\n}))\napp.add_route(\"/phone/&lt;int:pk&gt;\", PhoneViewSet.as_view({\n\"get\": \"retrieve\",\n\"post\": \"update\",\n\"put\": \"partial_update\",\n\"delete\": \"destroy\",\n}))\n# \u6216\u8005================================\nfrom bframe.generics import DefaultRouter\nrouter = DefaultRouter(app)\n# PhoneViewSet\nrouter.register(\"/phone\", PhoneViewSet)\nif __name__ == \"__main__\":\napp.run()\n</code></pre>"},{"location":"tutorial/#_8","title":"\u6846\u67b6\u9ed8\u8ba4\u914d\u7f6e","text":"<pre><code># session\u76f8\u5173\u7684\u9ed8\u8ba4\u914d\u7f6e\n\"SESSION_ID\": \"_session\"\n\"SESSION_MAX_AGE\": 604800  # a week\n\"SESSION_EXPIRES\": None\n\"SESSION_PATH\": \"/\"\n\"SESSION_DOMAIN\": None\n\"SESSION_SECURE\": False\n\"SESSION_HTTPONLY\": True\n\"SESSION_SAMESITE\": None\n\n# \u901a\u7528\u89c6\u56fe\u9ed8\u8ba4\u914d\u7f6e\n\"GENERIC_VIEW_DEFAULT_PRIMARY_KEY\": \"id\"                  # \u6570\u636e\u5e93\u4e3b\u952e\u540d\u79f0\n\"GENERIC_VIEW_DEFAULT_LIMIT\": 20                          # \u9ed8\u8ba4\u67e5\u8be2\u603b\u91cf\n\"GENERIC_VIEW_DEFAULT_LIMIT_KEY\": \"_limit\"                # \u9ed8\u8ba4\u67e5\u8be2\u603b\u91cfkey\n\"GENERIC_VIEW_DEFAULT_OFFSET\": 1                          # \u9ed8\u8ba4\u5206\u9875\u6570\n\"GENERIC_VIEW_DEFAULT_OFFSET_KEY\": \"_offset\"              # \u9ed8\u8ba4\u5206\u9875\u6570key\n\"GENERIC_VIEW_DEFAULT_ORDER_BY\": \"id\"                     # \u6570\u636e\u67e5\u8be2\u6392\u5e8f\u5b57\u6bb5\n\"GENERIC_VIEW_DEFAULT_ORDER_BY_KEY\": \"_order_by\"          # \u6570\u636e\u67e5\u8be2\u6392\u5e8f\u5b57\u6bb5key\n\"GENERIC_VIEW_DEFAULT_ORDER\": \"asc\"                       # \u6570\u636e\u67e5\u8be2\u6392\u5e8f\u5b57\u6bb5\u987a\u5e8f\n\"GENERIC_VIEW_DEFAULT_ORDER_KEY\": \"_order\"                # \u6570\u636e\u67e5\u8be2\u6392\u5e8f\u5b57\u6bb5\u987a\u5e8fkey\n</code></pre>"},{"location":"tutorial/#_9","title":"\u652f\u6301\u5b50\u5e94\u7528&amp;\u5b50\u5e94\u7528\u94a9\u5b50","text":"<pre><code>from bframe import Frame\nfrom bframe import YellowPrint\napp = Frame(__name__)\nsub_app = YellowPrint(\"/sub\")\napp.register_yellowprint(sub_app)\n# \u5b50\u5e94\u7528\u8bf7\u6c42\u94a9\u5b50\n@sub_app.add_before_app_handle\ndef before():\npass\n# \u5b50\u5e94\u7528\u54cd\u5e94\u94a9\u5b50\n@sub_app.add_after_app_handle\ndef after(response):\nreturn response\n@sub_app.get(\"/index\")\ndef sub_index():\nreturn \"index\"\n@app.get(\"/index\")\ndef index():\nreturn \"index\"\nif __name__ == \"__main__\":\napp.run()\n</code></pre>"},{"location":"tutorial/polls/","title":"Polls","text":""},{"location":"tutorial/polls/#app","title":"\u4e00\u3001\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684app\u5e94\u7528","text":"<ol> <li> <p>\u5b89\u88c5\u8f6f\u4ef6\u5305</p> <pre><code># \u786e\u4fdd\u60a8\u5df2\u7ecf\u5b89\u88c5python,\u5728\u7ec8\u7aef\u4e2d\u8f93\u5165\u6b64\u547d\u4ee4\u67e5\u770b\npython -V\n# \u5b89\u88c5\u672c\u9879\u76ee\u5305\npython -m pip install bframe\n# \u5b89\u88c5sqlalchemy\u5305\npython -m pip install sqlalchemy\n</code></pre> </li> <li> <p>\u7f16\u8f91\u6e90\u7801</p> <pre><code># app.py\nfrom bframe import Frame\napp = Frame(__name__)\n@app.get(\"/ping\")\ndef pong():\nreturn \"pong\"\nif __name__ == \"__main__\":\napp.run()\n</code></pre> </li> <li> <p>\u6267\u884c\u9879\u76ee\u4ee3\u7801</p> <pre><code>python app.py\n</code></pre> </li> <li> <p>\u6d4f\u89c8\u5668\u6253\u5f00<code>http://localhost:7256/ping</code>\u67e5\u770b</p> </li> </ol>"},{"location":"tutorial/polls/#_1","title":"\u4e8c\u3001\u7f16\u5199\u914d\u7f6e\u6587\u4ef6&amp;\u6570\u636e\u5e93\u6a21\u578b","text":"<ol> <li> <p>\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6</p> <pre><code># config.py\nSQLALCHEMY_DATABASE_URI = \"sqlite:///polls.db\"\n</code></pre> </li> <li> <p>\u7f16\u8f91\u6a21\u578b\u6587\u4ef6</p> <pre><code># models.py\nimport datetime\nfrom bframe import Frame\nfrom sqlalchemy import Column, DateTime, Integer, String, create_engine\nfrom sqlalchemy.engine.base import Engine\nfrom sqlalchemy.orm import declarative_base, scoped_session, sessionmaker\nSession: scoped_session = None\nengine: Engine = None\ndef init_models(app: Frame):\nglobal Session, engine\nurl = app.Config.get(\"SQLALCHEMY_DATABASE_URI\")\necho = app.Config.get(\"DEBUG\")\nengine = create_engine(url, echo=echo)\nSession = scoped_session(sessionmaker(engine))\nBase = declarative_base()\nclass User(Base):\n__tablename__ = 'users'\nid = Column(Integer, primary_key=True)\nusername = Column(String(100), unique=True, nullable=False, comment=\"\u7528\u6237\u540d\")\npassword = Column(String(100), nullable=False, comment=\"\u5bc6\u7801\")\ncreatetime = Column(DateTime, default=datetime.datetime.now,\ncomment=\"\u521b\u5efa\u65f6\u95f4\")\nupdatetime = Column(DateTime, default=datetime.datetime.now,\nonupdate=datetime.datetime.now, comment=\"\u4fee\u6539\u65f6\u95f4\")\nclass Question(Base):\n__tablename__ = 'questions'\nid = Column(Integer, primary_key=True)\ncontent = Column(String(256), nullable=False, comment=\"\u95ee\u9898\")\ncreatetime = Column(DateTime, default=datetime.datetime.now,\ncomment=\"\u521b\u5efa\u65f6\u95f4\")\nupdatetime = Column(DateTime, default=datetime.datetime.now,\nonupdate=datetime.datetime.now, comment=\"\u4fee\u6539\u65f6\u95f4\")\nclass Choice(Base):\n__tablename__ = 'choices'\nid = Column(Integer, primary_key=True)\nquestion = Column(Integer, nullable=False, comment=\"\u95ee\u9898id\")\ncontent = Column(String(256), nullable=False, comment=\"\u7ed3\u679c\")\nvotes = Column(Integer, default=0, comment=\"\u6295\u7968\u6570\u91cf\")\ncreatetime = Column(DateTime, default=datetime.datetime.now,\ncomment=\"\u521b\u5efa\u65f6\u95f4\")\nupdatetime = Column(DateTime, default=datetime.datetime.now,\nonupdate=datetime.datetime.now, comment=\"\u4fee\u6539\u65f6\u95f4\")\nclass UserChoice(Base):\n__tablename__ = 'user_choices'\nid = Column(Integer, primary_key=True)\nchoiceid = Column(Integer, nullable=False, comment=\"\u7ed3\u679c\")\nuserid = Column(Integer, nullable=False, comment=\"\u7528\u6237ID\")\ncreatetime = Column(DateTime, default=datetime.datetime.now,\ncomment=\"\u521b\u5efa\u65f6\u95f4\")\nupdatetime = Column(DateTime, default=datetime.datetime.now,\nonupdate=datetime.datetime.now, comment=\"\u4fee\u6539\u65f6\u95f4\")\ndef init_db(engine):\nBase.metadata.create_all(engine)\n</code></pre> </li> <li> <p>\u6539\u9020app.py\u6587\u4ef6</p> <pre><code>from bframe import Frame\ndef create_app(config):\napp = Frame(__name__)\n# \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\napp.Config.from_py(config)\n# init sqlalchemy object\nfrom models import init_models\ninit_models(app)\n# init db object\nfrom models import init_db, engine\ninit_db(engine)\n@app.get(\"/ping\")\ndef pong():\nreturn \"pong\"\nreturn app\napp = create_app(\"config.py\")\nif __name__ == \"__main__\":\napp.run()\n</code></pre> </li> <li> <p>\u9879\u76ee\u76ee\u5f55\u6811</p> <pre><code>.\n\u251c\u2500\u2500 app.py\n\u251c\u2500\u2500 config.py\n\u251c\u2500\u2500 models.py\n\u2514\u2500\u2500 polls.db\n</code></pre> </li> </ol>"},{"location":"tutorial/polls/#_2","title":"\u4e09\u3001\u89c6\u56fe\u7684\u5c0f\u8bd5\u725b\u5200","text":"<ol> <li> <p>\u7f16\u8f91\u89c6\u56fe\u6587\u4ef6</p> <pre><code># \u901a\u8fc7ViewSet\u5feb\u901f\u5b9e\u73b0\u63a5\u53e3\u7684crud\n# view.py\nfrom bframe.generics import ViewSet\nfrom bframe.serizlizer import DatetimeSerializer\nfrom models import Choice, Question, Session, User, UserChoice\nclass UserViewSet(ViewSet):\ntable_class = User\ntable_serializer = DatetimeSerializer\ndef get_session(self):\nreturn Session\nclass QuestionViewSet(ViewSet):\ntable_class = Question\ntable_serializer = DatetimeSerializer\ndef get_session(self):\nreturn Session\nclass ChoiceViewSet(ViewSet):\ntable_class = Choice\ntable_serializer = DatetimeSerializer\ndef get_session(self):\nreturn Session\nclass UserChoiceViewSet(ViewSet):\ntable_class = UserChoice\ntable_serializer = DatetimeSerializer\ndef get_session(self):\nreturn Session\n</code></pre> </li> <li> <p>\u6539\u9020app.py\u6587\u4ef6</p> <pre><code>from bframe import Frame\ndef create_app(config):\napp = Frame(__name__)\n# \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\napp.Config.from_py(config)\n# init sqlalchemy object\nfrom models import init_models\ninit_models(app)\n# init db object\nfrom models import init_db, engine\ninit_db(engine)\n# init apis\nfrom apis.views import UserViewSet, QuestionViewSet, ChoiceViewSet, UserChoiceViewSet\nfrom bframe.generics import DefaultRouter\nrouter = DefaultRouter(app)\nrouter.register(\"/users\", UserViewSet)\nrouter.register(\"/questions\", QuestionViewSet)\nrouter.register(\"/choices\", ChoiceViewSet)\nrouter.register(\"/user_choices\", UserChoiceViewSet)\n@app.get(\"/ping\")\ndef pong():\nreturn \"pong\"\nreturn app\napp = create_app(\"config.py\")\nif __name__ == \"__main__\":\napp.run()\n</code></pre> </li> <li> <p>\u76ee\u5f55\u6811</p> <pre><code>.\n\u251c\u2500\u2500 apis\n\u2502   \u2514\u2500\u2500 views.py\n\u251c\u2500\u2500 app.py\n\u251c\u2500\u2500 config.py\n\u251c\u2500\u2500 models.py\n\u2514\u2500\u2500 polls.db\n</code></pre> </li> <li> <p>\u901a\u8fc7curl\u67e5\u770b\u63a5\u53e3</p> <pre><code># \u521b\u5efa\u7528\u6237\ncurl http://localhost:7256/users -X POST -d \"username=tom&amp;password=tom\"\n# \u521b\u5efa\u95ee\u9898\ncurl http://localhost:7256/questions -X POST -d \"content=\u4f60\u559c\u6b22\u4e0b\u96e8\u5929\u6c14\u4e48\uff1f\"\n# \u83b7\u53d6\u95ee\u9898\ncurl http://localhost:7256/questions\n# \u521b\u5efa\u95ee\u9898\u7b54\u6848\ncurl http://localhost:7256/choices -X POST -d \"question=1&amp;content=\u559c\u6b22\"\ncurl http://localhost:7256/choices -X POST -d \"question=1&amp;content=\u4e0d\u559c\u6b22\"\n# \u83b7\u53d6\u95ee\u9898\u7b54\u6848\ncurl http://localhost:7256/choices\n# \u521b\u5efa\u6295\u7968\ncurl http://localhost:7256/user_choices -X POST -d \"userid=1&amp;choiceid=1\"\n# \u67e5\u8be2\u6295\u7968\ncurl http://localhost:7256/user_choices\n</code></pre> </li> </ol>"},{"location":"tutorial/polls/#_3","title":"\u56db\u3001\u6dfb\u52a0\u7528\u6237\u8ba4\u8bc1\u529f\u80fd\uff0c\u8ba9\u6295\u7968\u66f4\u5177\u5907\u771f\u5b9e\u6027","text":"<ol> <li> <p>\u5b9e\u73b0\u767b\u5f55\u88c5\u9970\u5668</p> <pre><code># utils.py\nfrom functools import wraps\nfrom bframe import g, session\nfrom models import Session, User\ndef login_decoroter(f):\n@wraps(f)\ndef wrapper(*args, **kwargs):\nuserid = session[\"userid\"]\nif not userid:\nreturn \"no login\"\nuser = Session.query(User).filter_by(id=userid).first()\nif not user:\nreturn \"no login\"\ng.user = user\nreturn f(*args, **kwargs)\nreturn wrapper\n</code></pre> </li> <li> <p>\u4e3a\u901a\u7528\u7c7b\u89c6\u56fe\u6dfb\u52a0\u88c5\u9970\u5668</p> <pre><code>class UserViewSet(ViewSet):\ntable_class = User\ntable_serializer = DatetimeSerializer\ndecorators = [login_decoroter]\ndef get_session(self):\nreturn Session\nclass QuestionViewSet(ViewSet):\ntable_class = Question\ntable_serializer = DatetimeSerializer\ndecorators = [login_decoroter]\ndef get_session(self):\nreturn Session\nclass ChoiceViewSet(ViewSet):\ntable_class = Choice\ntable_serializer = DatetimeSerializer\ndecorators = [login_decoroter]\ndef get_session(self):\nreturn Session\nclass UserChoiceViewSet(ViewSet):\ntable_class = UserChoice\ntable_serializer = DatetimeSerializer\ndecorators = [login_decoroter]\ndef get_session(self):\nreturn Session\n</code></pre> </li> <li> <p>\u7f16\u8f91\u7528\u6237\u6ce8\u518c\u89c6\u56fe</p> <pre><code># apis/views.py\nimport base64\nfrom bframe import MethodView, request, session\nfrom bframe.generics import ViewSet\nfrom bframe.serizlizer import DatetimeSerializer\nfrom models import Choice, Question, Session, User, UserChoice\nfrom utils import login_decoroter\nclass RegisterView(MethodView):\ndef post(self):\n\"\"\"\n        \u7528\u6237\u6ce8\u518c\n        \"\"\"\nusername = request.forms.get(\"username\")\npassword = request.forms.get(\"password\")\nif not all([username, password]):\nreturn {\n\"status\": False,\n\"msg\": \"\u53c2\u6570\u7f3a\u5931\"\n}\nuser = Session.query(User).filter_by(username=username).first()\nif user:\nreturn {\n\"status\": False,\n\"msg\": \"\u7528\u6237\u5df2\u6ce8\u518c\"\n}\n# base64\u7f16\u7801\u5bc6\u7801\u4e0d\u5b89\u5168\uff0c\u8bf7\u4f7f\u7528\u66f4\u5b89\u5168\u7684\u65b9\u5f0f\u4fdd\u5b58\u5bc6\u7801\nuser = User(username=username,\npassword=base64.b64encode(password.encode()).decode())\nSession.add(user)\nSession.commit()\nsession[\"userid\"] = user.id\nreturn {\n\"status\": True,\n\"msg\": \"\u767b\u5f55\u6210\u529f\"\n}\n</code></pre> </li> <li> <p>\u7f16\u8f91\u7528\u6237\u767b\u5f55\u89c6\u56fe</p> <pre><code># apis/views.py\nimport base64\nfrom bframe import MethodView, request, session\nfrom bframe.generics import ViewSet\nfrom bframe.serizlizer import DatetimeSerializer\nfrom models import Choice, Question, Session, User, UserChoice\nfrom utils import login_decoroter\nclass LoginView(MethodView):\ndef post(self):\n\"\"\"\n        \u7528\u6237\u767b\u5f55\n        \"\"\"\nusername = request.forms.get(\"username\")\npassword = request.forms.get(\"password\")\nif not all([username, password]):\nreturn {\n\"status\": False,\n\"msg\": \"\u53c2\u6570\u7f3a\u5931\"\n}\nuser = Session.query(User).filter_by(username=username).first()\nif not user:\nreturn {\n\"status\": False,\n\"msg\": \"\u7528\u6237\u4e0d\u5b58\u5728\"\n}\n# base64\u7f16\u7801\u5bc6\u7801\u4e0d\u5b89\u5168\uff0c\u8bf7\u4f7f\u7528\u66f4\u5b89\u5168\u7684\u65b9\u5f0f\u4fdd\u5b58\u5bc6\u7801\nif user.password != base64.b64encode(password.encode()).decode():\nreturn {\n\"status\": False,\n\"msg\": \"\u8d26\u53f7\u6216\u5bc6\u7801\u5f02\u5e38\"\n}\nsession[\"userid\"] = user.id\nreturn {\n\"status\": True,\n\"msg\": \"\u767b\u5f55\u6210\u529f\"\n}\n</code></pre> </li> <li> <p>\u66f4\u65b0app.py,\u6ce8\u518c\u89c6\u56fe,\u79fb\u9664\u90e8\u5206\u89c6\u56fe</p> <pre><code>from bframe import Frame\ndef create_app(config):\napp = Frame(__name__)\n# \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\napp.Config.from_py(config)\n# init sqlalchemy object\nfrom models import init_models\ninit_models(app)\n# init db object\nfrom models import init_db, engine\ninit_db(engine)\n# init apis\nfrom apis.views import RegisterView, LoginView, UserViewSet, QuestionViewSet, ChoiceViewSet, UserChoiceViewSet\nfrom bframe.generics import DefaultRouter\napp.add_route(\"/register\", RegisterView.as_view())\napp.add_route(\"/login\", LoginView.as_view())\nrouter = DefaultRouter(app)\n# router.register(\"/users\", UserViewSet)\nrouter.register(\"/questions\", QuestionViewSet)\nrouter.register(\"/choices\", ChoiceViewSet)\nrouter.register(\"/user_choices\", UserChoiceViewSet)\n@app.get(\"/ping\")\ndef pong():\nreturn \"pong\"\nreturn app\napp = create_app(\"config.py\")\nif __name__ == \"__main__\":\napp.run()\n</code></pre> </li> </ol>"},{"location":"tutorial/polls/#_4","title":"\u4e94\u3001\u7f16\u8f91\u524d\u7aef\u9875\u9762\uff0c\u63a5\u4e0a\u54b1\u4eec\u5f00\u53d1\u7684\u63a5\u53e3","text":"<ol> <li> <p>\u6dfb\u52a0\u524d\u53f0\u754c\u9762\uff08\u8fd9\u90e8\u5206\u4f7f\u7528vue2\u7f16\u8f91\uff0c\u4e0d\u592a\u660e\u767d\u7684\u5c0f\u4f19\u4f34\u8bf7\u79fb\u6b65\u81f3vue\u5b98\u7f51\u5b66\u4e60\uff08\u7b14\u8005\u53ea\u662f\u7565\u5fae\u4e86\u89e3\u524d\u7aef\uff09\uff09</p> <pre><code>&lt;!-- static/index.html --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n&lt;link href=\"https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/bootstrap/5.1.3/css/bootstrap.css\" type=\"text/css\"\nrel=\"stylesheet\" /&gt;\n&lt;script src=\"https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-y/bootstrap/5.1.3/js/bootstrap.js\"\ntype=\"application/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-y/axios/0.26.0/axios.js\"\ntype=\"application/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/vue/2.6.14/vue.js\"\ntype=\"application/javascript\"&gt;&lt;/script&gt;\n&lt;link rel=\"stylesheet\" href=\"main.css\"&gt;\n&lt;title&gt;polls&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"app\"&gt;\n&lt;div class=\"container-fluid\"&gt;\n&lt;div id=\"login\" v-if=\"showLogin\"&gt;\n&lt;div id=\"login-form\"&gt;\n&lt;form action=\"#\"&gt;\n&lt;h1 style=\"text-align: center;\"&gt;\u767b \u5f55&lt;/h1&gt;\n&lt;div class=\"mb-3 row\"&gt;\n&lt;label for=\"username-id-login\" class=\"col-sm-2 col-form-label\"&gt;\u7528\u6237\u540d&lt;/label&gt;\n&lt;div class=\"col-sm-10\"&gt;\n&lt;input type=\"text\" class=\"form-control\" id=\"username-id-login\" placeholder=\"\u8bf7\u586b\u5199\u7528\u6237\u540d\" v-model=\"username\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mb-3 row\"&gt;\n&lt;label for=\"password-id-login\" class=\"col-sm-2 col-form-label\"&gt;\u5bc6 \u7801&lt;/label&gt;\n&lt;div class=\"col-sm-10\"&gt;\n&lt;input type=\"password\" class=\"form-control\" id=\"password-id-login\" placeholder=\"\u8bf7\u586b\u5199\u5bc6\u7801\"\nv-model=\"password\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mb-3 row\"&gt;\n&lt;div class=\"col-sm-6\"&gt;\n&lt;input @click=\"LoginHandle\" type=\"button\" class=\"form-control\" id=\"submit-id-l-login\" value=\"\u767b \u5f55\"&gt;\n&lt;/div&gt;\n&lt;div class=\"col-sm-6\"&gt;\n&lt;input @click=\"RegisterHandle\" type=\"button\" class=\"form-control\" id=\"submit-id-l-register\" value=\"\u6ce8 \u518c\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div id=\"register\" v-if=\"showRegister\"&gt;\n&lt;div id=\"login-form\"&gt;\n&lt;form action=\"#\"&gt;\n&lt;h1 style=\"text-align: center;\"&gt;\u6ce8 \u518c&lt;/h1&gt;\n&lt;div class=\"mb-3 row\"&gt;\n&lt;label for=\"username-id-register\" class=\"col-sm-2 col-form-label\"&gt;\u7528\u6237\u540d&lt;/label&gt;\n&lt;div class=\"col-sm-10\"&gt;\n&lt;input type=\"text\" class=\"form-control\" id=\"username-id-register\" placeholder=\"\u8bf7\u586b\u5199\u7528\u6237\u540d\"\nv-model=\"username\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mb-3 row\"&gt;\n&lt;label for=\"password-id-register\" class=\"col-sm-2 col-form-label\"&gt;\u5bc6 \u7801&lt;/label&gt;\n&lt;div class=\"col-sm-10\"&gt;\n&lt;input type=\"password\" class=\"form-control\" id=\"password-id-register\" placeholder=\"\u8bf7\u586b\u5199\u5bc6\u7801\"\nv-model=\"password\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"mb-3 row\"&gt;\n&lt;div class=\"col-sm-6\"&gt;\n&lt;input @click=\"LoginHandle\" type=\"button\" class=\"form-control\" id=\"submit-id-r-login\" value=\"\u767b \u5f55\"&gt;\n&lt;/div&gt;\n&lt;div class=\"col-sm-6\"&gt;\n&lt;input @click=\"RegisterHandle\" type=\"button\" class=\"form-control\" id=\"submit-id-r-register\" value=\"\u6ce8 \u518c\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"polls-box\" id=\"polls\" v-if=\"showPolls\"&gt;\n&lt;div class=\"quesion-class\"&gt;\n&lt;div v-if=\"questions != undefined\"&gt;\n&lt;div v-if=\"cursor &gt;= questionCount\"&gt;\n&lt;span class=\"q\"&gt;{{ questions[0].content }}&lt;/span&gt;\n&lt;/div&gt;\n&lt;div v-else&gt;\n&lt;span class=\"q\"&gt;{{ questions[cursor].content }}&lt;/span&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"choice-class\"&gt;\n&lt;button @click=\"CommitChoiceHandle(item.id)\" class=\"tag\" v-for=\"item in choiceData\" :key=\"item.id\"&gt;\n        {{item.content}}\n        &lt;/button&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;script src=\"/main.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u76f8\u5173\u7684js\u4ee3\u7801</p> <pre><code>// static/main.js\nnew Vue({\nel: \"#app\",\ndata: {\nusername: \"\",\npassword: \"\",\ncursor: 0,\nquestions: undefined,\nquestionCount: 0,\nchoiceData: undefined,\nshowLogin: false,\nshowRegister: false,\nshowPolls: true,\n},\ncreated() {\nthis.CheckLogin();\nthis.GetQuestionsHandle();\nthis.GetQuestionsChoiceHandle();\n},\nwatch: {\ncursor: function (e) {\nthis.GetQuestionsChoiceHandle();\n}\n},\nmethods: {\nCheckLogin: function () {\nthat = this;\naxios({\nmethod: 'get',\nurl: location.origin + '/questions',\nresponseType: 'json'\n}).then(function (response) {\nif (response.data === \"no login\") {\nthat.showLogin = true;\nthat.showRegister = false;\nthat.showPolls = false;\n}\n})\n},\nGetQuestionsHandle: function () {\nthat = this;\naxios({\nmethod: 'get',\nurl: location.origin + '/questions',\nresponseType: 'json'\n}).then(function (response) {\nconsole.log(response);\nthat.questions = response.data.list;\nthat.questionCount = response.data.count;\n});\n},\nGetQuestionsChoiceHandle: function () {\nthat = this;\naxios({\nmethod: 'get',\nurl: location.origin + `/choices?question=${this.cursor + 1}`,\nresponseType: 'json'\n}).then(function (response) {\nthat.choiceData = response.data.list;\n});\n},\nCommitChoiceHandle: function (id) {\nthat = this;\naxios({\nmethod: 'post',\nurl: location.origin + `/user_choices`,\ndata: {\nchoiceid: id,\n},\nresponseType: 'json'\n}).then(function (response) {\nthat.choiceData = response.data.list;\nthat.cursor = that.cursor + 1 &gt;= that.questionCount ? 0 : that.cursor + 1;\n});\n},\nLoginHandle: function () {\nthis.showLogin = true;\nthis.showRegister = false;\nthis.showPolls = false;\nconsole.log(this.username, this.password);\nthat = this;\naxios({\nmethod: 'post',\nurl: location.origin + '/login',\ndata: {\nusername: this.username,\npassword: this.password,\n},\nresponseType: 'json'\n}).then(function (response) {\nif (response.data.status === true) {\nthat.showLogin = false;\nthat.showRegister = false;\nthat.showPolls = true;\n}\n})\n},\nRegisterHandle: function () {\nthis.showLogin = false;\nthis.showRegister = true;\nthis.showPolls = false;\nconsole.log(this.username, this.password);\nthat = this;\naxios({\nmethod: 'post',\nurl: location.origin + '/register',\ndata: {\nusername: this.username,\npassword: this.password,\n},\nresponseType: 'json'\n}).then(function (response) {\nif (response.data.status === true) {\nthat.showLogin = false;\nthat.showRegister = false;\nthat.showPolls = true;\n}\n})\n}\n}\n})\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u76f8\u5173\u7684css\u4ee3\u7801</p> <pre><code>/*\nstatic/main.css\n*/\n#login-form {\nwidth: 60%;\nmargin-top: 20%;\nmargin-left: auto;\nmargin-right: auto;\n}\n.polls-box {\nmargin: 10% auto;\ndisplay: flex;\nflex-direction: column;\njustify-content: space-between;\nalign-items: center;\n}\n.polls-box .quesion-class {\nbackground-color: rgb(98, 251, 213);\nbox-shadow: 10px 10px 2px 1px rgba(0, 0, 255, .2);\nborder-radius: 10px;\nwidth: 60%;\ntext-align: center;\n}\n.polls-box .choice-class {\nmargin-top: 20px;\nwidth: 60%;\ndisplay: flex;\nflex-direction: row;\njustify-content: space-between;\nalign-items: center;\n}\n.polls-box .choice-class .tag {\nbox-shadow: 10px 10px 2px 1px rgba(0, 0, 255, .2);\nbackground-color: rgb(111, 98, 251);\nborder-radius: 10px;\nwidth: 60%;\ntext-align: center;\n}\n.polls-box .quesion-class .q {\nfont-size: 100px;\n}\n.polls-box .choice-class .tag {\nfont-size: 60px;\nmargin-left: 2px;\nmargin-right: 2px;\n}\n</code></pre> </li> <li> <p>\u66f4\u65b0app.py\u652f\u6301\u524d\u7aef\u6587\u4ef6\u7684\u83b7\u53d6</p> <pre><code># app.py\nfrom bframe import Frame\nfrom bframe import Redirect\ndef create_app(config):\napp = Frame(__name__, static_url=\"\")\n# \u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\napp.Config.from_py(config)\n# init sqlalchemy object\nfrom models import init_models\ninit_models(app)\n# init db object\nfrom models import init_db, engine\ninit_db(engine)\n# init apis\nfrom apis.views import RegisterView, LoginView, UserViewSet, QuestionViewSet, ChoiceViewSet, UserChoiceViewSet\nfrom bframe.generics import DefaultRouter\napp.add_route(\"/register\", RegisterView.as_view())\napp.add_route(\"/login\", LoginView.as_view())\nrouter = DefaultRouter(app)\n# router.register(\"/users\", UserViewSet)\nrouter.register(\"/questions\", QuestionViewSet)\nrouter.register(\"/choices\", ChoiceViewSet)\nrouter.register(\"/user_choices\", UserChoiceViewSet)\n@app.get(\"/ping\")\ndef pong():\nreturn \"pong\"\n@app.get(\"/\")\n@app.get(\"/index\")\ndef index():\nreturn Redirect(\"/index.html\")\nreturn app\napp = create_app(\"config.py\")\nif __name__ == \"__main__\":\napp.run()\n</code></pre> </li> </ol>"}]}